<form id="payment-form" method="post">
  <div id="card-container"></div>
  <button id="card-button" type="submit">Pay Membership Fee</button>
  <input type="hidden" name="nonce" id="card-nonce">
</form>

<script type="text/javascript" src="https://sandbox.web.squarecdn.com/v1/square.js"></script>
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", async function () {
    const applicationId = "{{ application_id }}";
    const locationId = "LBA931MEK4R5V";  // Replace with your actual location ID

    const payments = Square.payments(applicationId, 'sandbox');
    const card = await payments.card();
    await card.attach('#card-container');

    document.querySelector('#payment-form').addEventListener('submit', async function (event) {
      event.preventDefault();
      const result = await card.tokenize();
      if (result.status === 'OK') {
        document.querySelector('#card-nonce').value = result.token;
        this.submit();
      } else {
        console.error(result.errors);
      }
    });
  });
</script>
